_format_version: "1.1"

# Erstelle services, welche unter http://apihost:8000/paths exponiert werden
# URL definiert die Zugriffe auf das Backend
# Plugins werden teilweise je Route oder je Service definiert
services:
# Allgemeiner Service
- name: etopen
  url: http://192.168.122.159/rules/etopen/
  routes:
  - name: etopen
    paths:
    - /rules/etopen
  plugins:
  - name: acl
    config:
      allow:
      - all

# Kunde kd1234
- name: kd-1234
  url: http://192.168.122.159/rules/kd-1234/
  routes:
  - name: kd-1234
    paths:
    - /rules/kd-1234
  plugins:
  - name: acl
    config:
      allow:
      - kd1234
# Kunde kd2234
- name: kd-2234
  url: http://192.168.122.159/rules/kd-2234/
  routes:
  - name: kd-2234
    paths:
    - /rules/kd-2234
  plugins:
  - name: acl
    config:
      allow:
      - kd2234

# Die key-auth global aktivieren, f√ºr jeden Service
plugins:
- name: key-auth

# Kunden anlegen, Credentials definieren und Gruppen zuweisen
consumers:
- username: kd1234
  keyauth_credentials:
  - key: "12341234"
  acls:
  - group: kd1234
  - group: all

- username: kd2234
  keyauth_credentials:
  - key: "22342234"
  acls:
  - group: kd2234
  - group: all
